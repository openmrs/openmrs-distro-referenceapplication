{
  "name": "Mother - Postnatal Form",
  "version": "1",
  "published": true,
  "retired": false,
  "pages": [
    {
      "label": "Visit Details",
      "sections": [
        {
          "label": "Patient ID Capture",
          "isExpanded": "true",
          "questions": [
            {
              "label": "Visit Date",
              "type": "obs",
              "id": "visit_date",
              "questionOptions": {
                "concept": "163260AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "date"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "false"
                  },
                  "validators": [
                    {
                      "type": "date",
                      "allowFutureDates": "false"
                    },
                    {
                      "type": "js_expression",
                      "failsWhenExpression": "isDateBefore(myValue, '1980-01-01') || myValue >= today()"
                    }
                  ]
                }
              ]
            },
            {
              "label": "Mother's patient identifier",
              "type": "obs",
              "id": "ptrackerid",
              "questionOptions": {
                "concept": "163530AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "text"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "false"
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "label": "HTS and ART",
      "sections": [
        {
          "label": "HIV Testing And ART Initiation",
          "isExpanded": "true",
          "questions": [
            {
              "label": "ANC HIV test status ",
              "type": "obs",
              "id": "testStatusAtANC",
              "questionOptions": {
                "concept": "164401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "fixed-value",
                "calculate": {
                  "calculateExpression": "resolve(api.getLatestObs(patient.id, '164401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', '677d1a80-dbbe-4399-be34-aa7f54f11405 '))?.valueCodeableConcept?.coding[0]?.code"
                },
                "answers": [
                  {
                    "concept": "1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Tested for HIV"
                  },
                  {
                    "concept": "1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Not tested for HIV"
                  },
                  {
                    "concept": "1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Unknown"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "true"
                  }
                }
              ]
            },
            {
              "label": "ANC HIV test result ",
              "type": "obs",
              "id": "ancHivTestResult",
              "questionOptions": {
                "concept": "159427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "calculate": {
                  "calculateExpression": "resolve(api.getLatestObs(patient.id, '159427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', '677d1a80-dbbe-4399-be34-aa7f54f11405 '))?.valueCodeableConcept?.coding[0]?.code"
                },
                "answers": [
                  {
                    "concept": "703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Positive"
                  },
                  {
                    "concept": "664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Negative"
                  },
                  {
                    "concept": "1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Unknown"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "true"
                  }
                }
              ]
            },
            {
              "label": "HIV Test Performed",
              "type": "obs",
              "id": "hiv_test",
              "questionOptions": {
                "concept": "164401AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "answers": [
                  {
                    "concept": "1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Yes"
                  },
                  {
                    "concept": "1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "No"
                  },
                  {
                    "concept": "1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Unknown"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "testStatusAtANC == '138571AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' || ancHivTestResult == '138571AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "HIV Test Result",
              "type": "obs",
              "id": "hiv-test-result",
              "questionOptions": {
                "concept": "159427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "answers": [
                  {
                    "concept": "1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Indeterminate"
                  },
                  {
                    "concept": "703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Positive"
                  },
                  {
                    "concept": "664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Negative"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "!includes('hiv-test','1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "ART Initiation",
              "type": "obs",
              "id": "art-initiation",
              "questionOptions": {
                "concept": "160117AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "answers": [
                  {
                    "concept": "160119AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Currently taking ART"
                  },
                  {
                    "concept": "160120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Started on ART"
                  },
                  {
                    "concept": "160121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Discontinued ART"
                  },
                  {
                    "concept": "160122AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Change of ART"
                  },
                  {
                    "concept": "1461AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Refused ART"
                  },
                  {
                    "concept": "160118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "ART Date Unknown"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "hiv-test-result !== '138571AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' && hiv-test !== '138571AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "ART Unique Number",
              "type": "obs",
              "id": "art-number",
              "questionOptions": {
                "concept": "164402AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "number"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "art-initiation !== '160119AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' || art-initiation !== '160120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "Reason why client has refused ART",
              "type": "obs",
              "id": "reason-for-refusing-art",
              "questionOptions": {
                "concept": "163322AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "textarea",
                "rows": ""
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "art-initiation !== '160018AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "ART Start Date",
              "type": "obs",
              "id": "art_start_date",
              "questionOptions": {
                "concept": "159599AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "date"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "art-initiation !== '160119AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' && art-initiation !== '160120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "Has the patient had a recent viral load test?",
              "type": "obs",
              "id": "recent-viral-load",
              "questionOptions": {
                "concept": "163310AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "answers": [
                  {
                    "concept": "1267AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Yes"
                  },
                  {
                    "concept": "1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Not done"
                  },
                  {
                    "concept": "1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Unknown"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "art-initiation !== '160119AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' && art-initiation !== '160120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "Viral Load Test Date",
              "type": "obs",
              "id": "viral_load_test_date",
              "questionOptions": {
                "concept": "163281AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "date"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "!includes('recent-viral-load','1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "Viral Load Results",
              "type": "obs",
              "id": "viral-load-results",
              "questionOptions": {
                "concept": "1305AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "radio",
                "answers": [
                  {
                    "concept": "159971AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Results pending"
                  },
                  {
                    "concept": "1304AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Sample Rejected"
                  },
                  {
                    "concept": "1301AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Detected"
                  },
                  {
                    "concept": "1302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Not Detected"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "hide": {
                    "hideWhenExpression": "!includes('recent-viral-load','1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')"
                  },
                  "validators": []
                }
              ]
            },
            {
              "label": "Viral Load Copies",
              "type": "obs",
              "id": "viral_load_copies",
              "questionOptions": {
                "concept": "856AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "number"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "!includes('viral-load-results','1301AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')"
                  },
                  "validators": []
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "label": "Next Appointment",
      "sections": [
        {
          "label": "Follow Up",
          "isExpanded": "true",
          "questions": [
            {
              "label": "Next Vist Date",
              "type": "obs",
              "id": "next_visit_date",
              "questionOptions": {
                "concept": "5096AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rendering": "date"
              },
              "behaviours": [
                {
                  "intent": "*",
                  "required": "true",
                  "unspecified": "true",
                  "hide": {
                    "hideWhenExpression": "false"
                  },
                  "validators": [
                    {
                      "type": "date",
                      "allowFutureDates": "true"
                    },
                    {
                      "type": "js_expression",
                      "failsWhenExpression": "myValue <= useFieldValue('visit_date')",
                      "message": "Next visit date cannot be less than current visit date"
                    }
                  ]
                }
              ]
            },
            {
              "label": "Facility of next appointment",
              "type": "obs",
              "required": false,
              "id": "facilityName",
              "questionOptions": {
                "rendering": "text",
                "concept": "162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "conceptMappings": [
                  {
                    "relationship": "SAME-AS",
                    "type": "CIEL",
                    "value": "160632"
                  },
                  {
                    "relationship": "SAME-AS",
                    "type": "AMPATH",
                    "value": "1915"
                  }
                ]
              }
            }
          ]
        }
      ]
    }
  ],
  "availableIntents": [
    {
      "intent": "*",
      "display": "Postnatal Form"
    }
  ],
  "processor": "EncounterFormProcessor",
  "uuid": "xxxx",
  "referencedForms": [],
  "encounterType": "4362fd2d-1866-4ea0-84ef-5e5da9627440",
  "encounter": "Postnatal",
  "postSubmissionActions": [
    "ArtSubmissionAction"
  ],
  "allowUnspecifiedAll": true
}
